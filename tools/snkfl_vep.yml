outdir = config['outdir']
upper_var_gwas_cat_count = config['upper_var_gwas_cat_count']


rule all_03snkfl_analysis_vep:
    input:
        os.path.join(outdir, "pltbar_vep_consequence.py/missense_variant.png"),

rule plt_vep_consequence:
    input:
        os.path.join(outdir, "cmpt_vep_consequence_fisher.py/cons_stat.tsv"),
    output:
        os.path.join(outdir, "pltbar_vep_consequence.py/missense_variant.png"),
    params:
        upper_var_gwas_cat_count=(upper_var_gwas_cat_count-1)
    shell:
        "python scripts/pltbar_vep_consequence.py {input[0]} {params[0]} {output[0]}"

rule cmpt_vep_consequence_fisher:
    input:
        os.path.join(outdir, "cmpt_vep.py/vep_input.tsv"),
        os.path.join(outdir, "cmpt_vep.py/vep_output.tsv"),
    output:
        os.path.join(outdir, "cmpt_vep_consequence_fisher.py/cons_stat.tsv"),
    params:
        upper_var_gwas_cat_count=(upper_var_gwas_cat_count-1)
    shell:
        "python scripts/cmpt_vep_consequence_fisher.py {input[0]} {input[1]} {params.upper_var_gwas_cat_count} {output[0]}"

rule cmpt_vep:
    input:
        os.path.join(outdir, "filter_h4.py/h4.tsv.gz"),
        os.path.join(outdir, "cmpt_count_per_rsid.py/count_per_rsid_gwas.tsv"),
    output:
        os.path.join(outdir, "cmpt_vep.py/vep_input.tsv"),
        os.path.join(outdir, "cmpt_vep.py/vep_output.tsv"),
    params:
        upper_var_gwas_cat_count=(upper_var_gwas_cat_count-1)
    shell:
        "python scripts/cmpt_vep.py {input[0]} {input[1]} {params.upper_var_gwas_cat_count} {output[0]} {output[1]}"
